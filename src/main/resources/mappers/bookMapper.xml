<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="project.aban.test.dao.BookMapper">
	<insert id="insert_book" parameterType="java.util.List">
	<foreach collection="list" item="book" index="index" separator=" " open="INSERT ALL " close="SELECT * FROM DUAL">
		into book(
         	book_num,
			book_title,
			book_image,
			book_writer,
			book_date,
			book_publisher,
			book_content,
			book_likecount,
			book_viewcount,
			book_scrapcount
      		)values
			(
				#{book.book_num},
				#{book.book_title},
				#{book.book_image},
				#{book.book_writer},
				#{book.book_date},
				#{book.book_publisher},
				#{book.book_content},
				0,
                0,
                0
            )
		</foreach>
	</insert>

    <select id="show_all_book" resultType="Book">
        SELECT * FROM book
        where rownum between 1 and 40
            
	</select>


	<select id="select_book" parameterType="Book" resultType="Book">
		select distinct
			book_num,
			book_title,
			book_image,
			book_writer,
			book_date,
			book_publisher,
			book_likecount
		from book
			where book_title = #{book_title}
			and book_image = #{book_image}
			and book_publisher = #{book_publisher}
	</select>
	
	<insert id="insert_tag" parameterType="java.util.List">
		<foreach collection="list" item="tag" index="index" separator=" " open="INSERT ALL " close="SELECT * FROM DUAL">
		into tag(
			tag_seq,
			tag,
			tag_count,
			hit_count,
			tag_count,
			tag_image
		)values(
			TAG_SEQ.NEXTVAL,
			#{tag},
			#{tag_count},
			0,
			0,
			#{tag_image}
		)
		</foreach>
	</insert>

</mapper>